!function(e){"use strict";const t=[{name:"base58",charset:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"},{name:"base64",charset:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"},{name:"base64url",charset:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"}];function n(e){for(const n of t)if(n.name===e)return n.charset;throw TypeError("Charset does not exist: "+e)}const r={encode:function(e,t,r=!1){const o=n(t),s=o.length,i=[];let c,a,u,f="",l=0;for(c=0;c<e.length;c++)for(l=0,a=e[c],f+=a>0||(f.length^c)>0?"":"1";l in i||a>0;)u=i[l],u=u>0?256*u+a:a,a=u/s|0,i[l]=u%s,l++;for(;l-- >0;)f+=o[i[l]];return r&&f.length%4>0?f+"=".repeat(4-f.length%4):f},decode:function(e,t){const r=n(t),o=r.length,s=[],i=[];e=e.replace("=","");let c,a,u,f=0;for(c=0;c<e.length;c++){if(f=0,a=r.indexOf(e[c]),a<0)throw new Error(`Character range out of bounds: ${a}`);for(c=a>0||(i.length^c)>0?c:i.push(0);f in s||a>0;)u=s[f],u=u>0?u*o+a:a,a=u>>8,s[f]=u%256,f++}for(;f-- >0;)i.push(s[f]);return Uint8Array.from(i)}},o="qpzry9x8gf2tvdw0s3jn54khce6mua7l",s=[996825010,642813549,513874426,1027748829,705979059],i="bech32",c="bech32m";function a(e){switch(e){case i:return 1;case c:return 734539939;default:throw new Error(`Unrecognized encoding: ${e}`)}}function u(e){let t=1;for(let n=0;n<e.length;++n){const r=t>>25;t=(33554431&t)<<5^e[n];for(let e=0;e<5;++e)(r>>e&1)>0&&(t^=s[e])}return t}function f(e){const t=[];let n;for(n=0;n<e.length;++n)t.push(e.charCodeAt(n)>>5);for(t.push(0),n=0;n<e.length;++n)t.push(31&e.charCodeAt(n));return t}function l(e,t,n,r=!0){const o=[];let s=0,i=0;const c=(1<<n)-1,a=(1<<t+n-1)-1;for(const r of e){if(r<0||r>>t>0)return[];for(s=(s<<t|r)&a,i+=t;i>=n;)i-=n,o.push(s>>i&c)}if(r)i>0&&o.push(s<<n-i&c);else if(i>=t||(s<<n-i&c)>0)return[];return o}function h(e,t,n){const r=t.concat(function(e,t,n){const r=u(f(e).concat(t).concat([0,0,0,0,0,0]))^a(n),o=[];for(let e=0;e<6;++e)o.push(r>>5*(5-e)&31);return o}(e,t,n));let s=e+"1";for(let e=0;e<r.length;++e)s+=o.charAt(r[e]);return s}function g(e,t){const n=t>0?"bech32m":"bech32";if(!function(e){let t,n,r=!1,o=!1;for(t=0;t<e.length;++t){if(n=e.charCodeAt(t),n<33||n>126)return!1;n>=97&&n<=122&&(r=!0),n>=65&&n<=90&&(o=!0)}return!(r&&o)}(e))return{hrp:null,data:[255]};if(!function(e){const t=e.lastIndexOf("1");return!(t<1||t+7>e.length||e.length>90)}(e=e.toLowerCase()))return{hrp:null,data:[255]};const r=[],s=e.lastIndexOf("1"),i=e.substring(0,s);for(let t=s+1;t<e.length;++t){const n=o.indexOf(e.charAt(t));if(-1===n)return{hrp:null,data:[255]};r.push(n)}return function(e,t,n){return u(f(e).concat(t))===a(n)}(i,r,n)?{hrp:i,data:r.slice(0,r.length-6)}:{hrp:null,data:[255]}}function p(e,t=0){const n=e.split("1",1)[0],{hrp:r,data:o}=g(e,t),s=l(o.slice(1),5,8,!1),i=s.length;switch(!0){case n!==r:throw new Error("Returned hrp string is invalid.");case null===s||i<2||i>40:throw new Error("Decoded string is invalid or out of spec.");case o[0]>16:throw new Error("Returned version bit is out of range.");case 0===o[0]&&20!==i&&32!==i:throw new Error("Decoded string does not match version 0 spec.");case 0===o[0]&&0!==t:case 0!==o[0]&&1!==t:throw new Error("Decoded version bit does not match.");default:return Uint8Array.from(s)}}const d={encode:function(e,t="bch",n=0){const r=h(t,[n,...l([...e],8,5)],n>0?"bech32m":"bech32");return p(r,n),r},decode:p};function y(e){return(new TextEncoder).encode(e).buffer}function w(e){return(new TextDecoder).decode(e)}function b(e){let t,n=0;for(t=e.length-1;t>=0;t--)n=256*n+e[t];return Number(n)}function m(e){let t,n=0n;for(t=e.length-1;t>=0;t--)n=256n*n+BigInt(e[t]);return BigInt(n)}class A extends Uint8Array{constructor(e,t=null,n="be"){if(null!==t){const n=new Uint8Array(t).fill(0);n.set(new Uint8Array(e)),e=n.buffer}return super(e="le"===n?new Uint8Array(e).reverse():e),this}toNum(e="le"){return b("le"===e?this.reverse():this)}toBig(e="le"){return m("le"===e?this.reverse():this)}toArr(){return Array.from(this)}toStr(){return w(this)}toHex(){return function(e){const t=[];let n;for(n=0;n<e.length;n++)t.push(e[n].toString(16).padStart(2,"0"));return t.join("")}(this)}toJson(){return JSON.parse(w(this))}toBytes(){return new Uint8Array(this)}toBase58(){return r.encode(this,"base58")}toB64url(){return r.encode(this,"base64url")}toBech32(e,t){return d.encode(this,e,t)}toBase64(e){return r.encode(this,"base64",e)}prepend(e){return A.of(...e,...this)}append(e){return A.of(...this,...e)}slice(e,t){return new A(new Uint8Array(this).slice(e,t))}reverse(){return new A(new Uint8Array(this).reverse())}write(e,t){this.set(e,t)}addVarint(e=this.length){return A.of(...A.getVarint(e),...this)}static from(e){return new A(Uint8Array.from(e))}static of(...e){return new A(Uint8Array.of(...e))}static join(e){let t,n=0;const r=e.reduce(((e,t)=>e+t.length),0),o=new Uint8Array(r);for(const r of e)for(t=0;t<r.length;n++,t++)o[n]=r[t];return new A(o,r)}static getVarint(e){if(e<253)return A.num(e,1);if(e<65536)return A.of(253,...A.num(e,2));if(e<4294967296)return A.of(254,...A.num(e,4));if(e<0x10000000000000000)return A.of(255,...A.num(e,8));throw new Error(`Value is too large: ${e}`)}static random(e=32){return new A(crypto.getRandomValues(new Uint8Array(e)))}static normalizeBytes(e,t){if("string"==typeof e)return A.hex(e,t).toBytes();if("number"==typeof e)return A.num(e,t).toBytes();if("bigint"==typeof e)return A.big(e,t).toBytes();if(e instanceof Uint8Array)return A.buff(e,t).toBytes();throw TypeError("Unrecognized format: "+typeof e)}static normalizeData(e){if("string"==typeof e)return A.str(e).toBytes();if("object"==typeof e){if(e instanceof Uint8Array)return e;try{return A.json(e).toBytes()}catch{throw TypeError("Object is not serializable.")}}throw TypeError("Unrecognized format: "+typeof e)}}A.num=(e,t,n="le")=>new A(function(e){const t=[];for(;e>0;){const n=255&e;t.push(n),e=(e-n)/256}return Uint8Array.from(t)}(e),t,n),A.big=(e,t,n="le")=>new A(function(e){const t=[];for(;e>0n;){const n=0xffn&e;t.push(Number(n)),e=(e-n)/256n}return Uint8Array.from(t)}(e),t,n),A.buff=(e,t)=>new A(e,t),A.str=(e,t)=>new A(y(e),t),A.hex=(e,t)=>new A(function(e){const t=[];let n,r=0;if(e.length%2>0)throw new Error(`Invalid hex string length: ${e.length}`);for(n=0;n<e.length;n+=2)t[r]=parseInt(e.slice(n,n+2),16),r+=1;return Uint8Array.from(t).buffer}(e),t),A.json=e=>new A(y(JSON.stringify(e))),A.bech32=(e,t)=>new A(d.decode(e,t)),A.base58=e=>new A(r.decode(e,"base58")),A.base64=e=>new A(r.decode(e,"base64")),A.b64url=e=>new A(r.decode(e,"base64url"));const x={null:e=>null===e,undefined:e=>void 0===e,hex:e=>function(e){switch(!0){case"string"!=typeof e:case/[^0-9a-fA-F]/.test(e):case e.length%2!=0:return!1;default:return!0}}(e),string:e=>"string"==typeof e,infinity:e=>e===1/0,bigint:e=>"bigint"==typeof e,number:e=>"number"==typeof e,class:e=>"object"==typeof e?.prototype&&e.toString().startsWith("class"),function:e=>"function"==typeof e,uint8:e=>e instanceof Uint8Array,uint16:e=>e instanceof Uint16Array,uint32:e=>e instanceof Uint32Array,buffer:e=>e instanceof ArrayBuffer,array:e=>Array.isArray(e),object:e=>"object"==typeof e};const U=x,v=/[\p{Lu}]/u,B=/[\p{Ll}]/u,E=/^[\p{Lu}](?![\p{Lu}])/gu,j=/([\p{Alpha}\p{N}_]|$)/u,C=/[_.\- ]+/,I=new RegExp("^"+C.source),S=new RegExp(C.source+j.source,"gu"),T=new RegExp("\\d+"+j.source,"gu");function q(e,t){if("string"!=typeof e&&!Array.isArray(e))throw new TypeError("Expected the input to be `string | string[]`");if(t={pascalCase:!1,preserveConsecutiveUppercase:!1,...t},0===(e=Array.isArray(e)?e.map((e=>e.trim())).filter((e=>e.length)).join("-"):e.trim()).length)return"";const n=!1===t.locale?e=>e.toLowerCase():e=>e.toLocaleLowerCase(t.locale),r=!1===t.locale?e=>e.toUpperCase():e=>e.toLocaleUpperCase(t.locale);if(1===e.length)return C.test(e)?"":t.pascalCase?r(e):n(e);return e!==n(e)&&(e=((e,t,n)=>{let r=!1,o=!1,s=!1;for(let i=0;i<e.length;i++){const c=e[i];r&&v.test(c)?(e=e.slice(0,i)+"-"+e.slice(i),r=!1,s=o,o=!0,i++):o&&s&&B.test(c)?(e=e.slice(0,i-1)+"-"+e.slice(i-1),s=o,o=!1,r=!0):(r=t(c)===c&&n(c)!==c,s=o,o=n(c)===c&&t(c)!==c)}return e})(e,n,r)),e=e.replace(I,""),e=t.preserveConsecutiveUppercase?((e,t)=>(E.lastIndex=0,e.replace(E,(e=>t(e)))))(e,n):n(e),t.pascalCase&&(e=r(e.charAt(0))+e.slice(1)),((e,t)=>(S.lastIndex=0,T.lastIndex=0,e.replace(S,((e,n)=>t(n))).replace(T,(e=>t(e)))))(e,r)}var L="@cmdcode/buff-utils";const N="../src/index.js";let O;async function R(e){O=e;const t=q(String("/"+L).split("/").at(-1)),n=await async function(e){if("undefined"!=typeof window)return window[e];const t=process?.argv&&process.argv.length>2?process.argv.slice(2,3):N;if(String(t).includes("main"))throw new Error("Unable to run tests on a commonJs module!");return console.log(`Testing package: ${t}`),import("../"+t).then((e=>e.default?e.default:e))}(t);$(n)}async function $(e,t=[]){for(const[n,r]of Object.entries(e))if(U.class(r)){const e=[...t,n];z(r,e),$(r,e),console.log("Registering tests for class:",n)}else if(U.function(r))D(n,r,t);else if(U.object(r)){$(r,[...t,n])}}async function z(e,t){const n=[...t,"new"];for(const t of Object.getOwnPropertyNames(e.prototype))D(t,e,n)}async function D(e,t,n){const r=`./api/${n.join("/").toLowerCase()}/${e}.test.js`;import(r).then((e=>{for(const n of Object.keys(e))O.test(r.split("/").at(-1),(r=>{console.log(`Running ${n} tests:\n`),e[n](r,t)}))})).catch((e=>{e.message.includes("Cannot find module")||console.log(`Failed to import test for: ${r}\n${e}`)}))}function V(e){const t=function(e=2164260863){return Math.floor(Math.random()*e)}(),n=BigInt(t),r=t.toString(16).padStart(8,"0"),o=A.num(t).toNum(),s=A.num(t).toBig(),i=A.big(n).toBig(),c=A.big(n).toNum(),a=A.hex(r).toHex(),u=A.hex(r).toNum(),f=A.hex(r).toBig(),l=A.num(t).toHex(),h=A.big(n).toHex();e.plan(9),e.equal(o,t,"num => num"),e.equal(s,n,"num => big"),e.equal(l,r,"num => hex"),e.equal(i,n,"big => big"),e.equal(c,t,"big => num"),e.equal(h,r,"big => hex"),e.equal(a,r,"hex => hex"),e.equal(u,t,"hex => num"),e.equal(f,n,"hex => big")}e("Bytes-utils Test Suite",(async e=>{e.test("API Tests",(async e=>{await R(e)})),e.test("Integrity Tests",(e=>{V(e)}))}))}(tape);
